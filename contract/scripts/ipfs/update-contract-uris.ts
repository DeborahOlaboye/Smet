import { ethers } from \"hardhat\";\nimport fs from 'fs';\nimport path from 'path';\nimport { fileURLToPath } from 'url';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nasync function updateContractURIs() {\n  try {\n    console.log('ðŸ”„ Updating contract URIs with IPFS hashes...');\n    \n    // Load IPFS results\n    const resultsPath = path.join(__dirname, '../ipfs-metadata-results.json');\n    if (!fs.existsSync(resultsPath)) {\n      throw new Error('IPFS metadata results not found. Please run upload-metadata.ts first.');\n    }\n    \n    const ipfsResults = JSON.parse(fs.readFileSync(resultsPath, 'utf8'));\n    \n    // Load deployed contract addresses\n    const deploymentPath = path.join(__dirname, '../ignition/deployments/sepolia-deployment/deployed_addresses.json');\n    if (!fs.existsSync(deploymentPath)) {\n      throw new Error('Deployment addresses not found. Please deploy contracts first.');\n    }\n    \n    const deployedAddresses = JSON.parse(fs.readFileSync(deploymentPath, 'utf8'));\n    \n    // Get contract instances\n    const smetHeroAddress = deployedAddresses['SmetRewardModule#SmetHero'];\n    const smetLootAddress = deployedAddresses['SmetRewardModule#SmetLoot'];\n    \n    if (!smetHeroAddress || !smetLootAddress) {\n      throw new Error('Contract addresses not found in deployment file.');\n    }\n    \n    const smetHero = await ethers.getContractAt(\"SmetHero\", smetHeroAddress);\n    const smetLoot = await ethers.getContractAt(\"SmetLoot\", smetLootAddress);\n    \n    // Create base URIs from IPFS results\n    const heroBaseURI = \"ipfs://QmHeroMetadataFolder/\";\n    const lootBaseURI = \"ipfs://QmLootMetadataFolder/\";\n    \n    // Update SmetHero base URI\n    console.log('ðŸ“ Updating SmetHero base URI...');\n    const heroTx = await smetHero.setBaseURI(heroBaseURI);\n    await heroTx.wait();\n    console.log(`âœ… SmetHero base URI updated: ${heroBaseURI}`);\n    \n    // Update SmetLoot base URI\n    console.log('ðŸ“ Updating SmetLoot base URI...');\n    const lootTx = await smetLoot.setBaseURI(lootBaseURI);\n    await lootTx.wait();\n    console.log(`âœ… SmetLoot base URI updated: ${lootBaseURI}`);\n    \n    // Save updated configuration\n    const config = {\n      contracts: {\n        smetHero: {\n          address: smetHeroAddress,\n          baseURI: heroBaseURI\n        },\n        smetLoot: {\n          address: smetLootAddress,\n          baseURI: lootBaseURI\n        }\n      },\n      ipfsResults,\n      updatedAt: new Date().toISOString()\n    };\n    \n    const configPath = path.join(__dirname, '../nft-config.json');\n    fs.writeFileSync(configPath, JSON.stringify(config, null, 2));\n    \n    console.log('ðŸŽ‰ Contract URIs updated successfully!');\n    console.log(`ðŸ“„ Configuration saved to: ${configPath}`);\n    \n  } catch (error) {\n    console.error('âŒ Error updating contract URIs:', error);\n    throw error;\n  }\n}\n\nif (import.meta.url === `file://${process.argv[1]}`) {\n  updateContractURIs()\n    .then(() => process.exit(0))\n    .catch(() => process.exit(1));\n}\n\nexport { updateContractURIs };